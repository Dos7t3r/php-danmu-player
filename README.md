---

# ğŸ¥ OldBili Player v1.3.4 - PHP + MySQL å¢å¼ºç‰ˆå¼¹å¹•æ’­æ”¾å™¨

**ä¸€ä¸ªä»¿å“”å“©å“”å“©é£æ ¼ã€åŸºäº ArtPlayer.js æ„å»ºçš„ç°ä»£åŒ–å¼¹å¹•è§†é¢‘æ’­æ”¾å™¨ï¼Œç°å·²å…¨é¢å‡çº§ä¸º MySQL æ•°æ®åº“å­˜å‚¨åœ¨çº¿ç”¨æˆ·æ•°æ®ï¼Œæ›´ç¨³å®šã€æ›´é«˜æ•ˆï¼Œé€‚åˆåµŒå…¥ç½‘ç«™ã€åšå®¢ä¸å„ç±» Web åº”ç”¨ä¸­ã€‚**

---

## ğŸš€ æ›´æ–°æ—¥å¿— (v1.3.4)

- ğŸ›¢ï¸ **å…¨é¢ä½¿ç”¨ MySQL æ•°æ®åº“**ï¼šé«˜æ•ˆå­˜å‚¨åœ¨çº¿ç”¨æˆ·æ•°æ®ï¼Œè§£å†³ XML æ–‡ä»¶å¹¶å‘æŸåé—®é¢˜ã€‚
- ğŸ ä¿®å¤åœ¨çº¿äººæ•°å¿ƒè·³å¤±è´¥é—®é¢˜ï¼Œæå‡ç¨³å®šæ€§ã€‚
- âš™ï¸ ä¼˜åŒ– PHP åç«¯è„šæœ¬ï¼Œæå‡å“åº”é€Ÿåº¦ã€‚

---

## âœ¨ åŠŸèƒ½äº®ç‚¹

- ğŸ“º **å¼¹å¹•å…¨é¢æ”¯æŒ**ï¼šè‡ªå®šä¹‰é¢œè‰²ã€ä½ç½®ï¼ˆæ»šåŠ¨ / é¡¶éƒ¨ / åº•éƒ¨ï¼‰ï¼Œå®æ—¶å¼¹å¹•æ˜¾ç¤ºã€‚
- ğŸ”„ **å“åº”å¼å¼¹å¹•å­—å·**ï¼šè‡ªåŠ¨æ ¹æ®å±å¹•å°ºå¯¸è°ƒæ•´å­—ä½“å¤§å°ï¼Œä¼˜åŒ–ä¸åŒè®¾å¤‡ä½“éªŒã€‚
- ğŸ“‹ **å¼¹å¹•åˆ—è¡¨é¢æ¿**ï¼šä¸€é”®æŸ¥çœ‹æ‰€æœ‰å¼¹å¹•ï¼Œå«å‘é€æ—¶é—´ã€å†…å®¹ã€è§†é¢‘ä½ç½®ã€‚
- ğŸ“¡ **åœ¨çº¿äººæ•°ç»Ÿè®¡**ï¼šåŸºäº MySQL æ•°æ®åº“é«˜æ•ˆè®°å½•åœ¨çº¿ç”¨æˆ·ï¼Œé€šè¿‡å®šæ—¶å¿ƒè·³å®æ—¶ç»Ÿè®¡ã€‚
- ğŸ¨ **é«˜é¢œå€¼é€šçŸ¥ç³»ç»Ÿ**ï¼šç¾è§‚æ¸…æ™°å±•ç¤ºåŠ è½½ä¸­ã€å‘é€æˆåŠŸæˆ–å¤±è´¥æç¤ºã€‚
- âš™ï¸ **åŠ¨æ€å¼¹å¹•åŠ è½½**ï¼šé€šè¿‡ URL å‚æ•°çµæ´»åŠ è½½è§†é¢‘ä¸å¼¹å¹•èµ„æºã€‚
- ğŸš¨ **å®‰å…¨è­¦å‘Šæç¤º**ï¼šé˜²æ­¢æ§åˆ¶å°ç²˜è´´æ¶æ„ä»£ç ã€‚
- ğŸ“± **ç§»åŠ¨ç«¯è‡ªé€‚åº”**ï¼šå…¨é¢å…¼å®¹æ¡Œé¢ä¸ç§»åŠ¨è®¾å¤‡ã€‚

---

## ğŸ”§ æŠ€æœ¯æ ˆ

- **ArtPlayer.js** - HTML5 è§†é¢‘æ’­æ”¾å™¨æ ¸å¿ƒç»„ä»¶
- **artplayer-plugin-danmuku** - å¼¹å¹•æ’ä»¶æ”¯æŒ
- **JavaScript + DOM æ“ä½œ** - å®ç° UI æ§åˆ¶ä¸äº¤äº’é€»è¾‘
- **Fetch API** - å‰åç«¯æ•°æ®äº¤äº’ï¼ˆå¼¹å¹•ã€åœ¨çº¿ç»Ÿè®¡ï¼‰
- **PHP + MySQL** - åç«¯å¤„ç†å¼¹å¹•æ•°æ®ä¸åœ¨çº¿äººæ•°ç»Ÿè®¡

---

## ğŸ“ é¡¹ç›®ç»“æ„è¯´æ˜

```
project-root/
â”œâ”€â”€ index.html              // æ’­æ”¾å™¨ä¸»é¡µé¢
â”œâ”€â”€ sendDanmu.php           // å¼¹å¹•æ•°æ®æ¥æ”¶ä¸å­˜å‚¨
â”œâ”€â”€ online.php              // åœ¨çº¿äººæ•°ç»Ÿè®¡æ¥å£ï¼ˆå·²å‡çº§ä¸ºMySQLæ•°æ®åº“ç‰ˆï¼‰
â”œâ”€â”€ js/
â”‚   â”œâ”€â”€ artplayer.js              // ArtPlayeræ’­æ”¾å™¨æ ¸å¿ƒ
â”‚   â””â”€â”€ artplayer-plugin-danmuku.js // å¼¹å¹•æ’ä»¶
```

---

## ğŸ”Œ å¿«é€Ÿä½¿ç”¨

### 1. å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®

```bash
git clone https://github.com/Dos7t3r/php-danmu-player
```

### 2. åˆ›å»º MySQL æ•°æ®åº“ï¼ˆæ¨èä½¿ç”¨å®å¡”é¢æ¿ï¼‰

```sql
CREATE TABLE `online_users` (
    `id` INT AUTO_INCREMENT PRIMARY KEY,
    `user_id` VARCHAR(64) NOT NULL UNIQUE,
    `video_id` VARCHAR(64) DEFAULT '',
    `last_active` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX (`video_id`),
    INDEX (`last_active`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

### 3. ä¿®æ”¹ PHP æ•°æ®åº“è¿æ¥é…ç½®ï¼ˆ`online.php`ï¼‰

```php
$dbConfig = [
    'host'     => 'localhost',
    'dbname'   => 'ä½ çš„æ•°æ®åº“å',
    'username' => 'ä½ çš„æ•°æ®åº“ç”¨æˆ·å',
    'password' => 'ä½ çš„æ•°æ®åº“å¯†ç ',
    'charset'  => 'utf8mb4'
];
```

### 4. éƒ¨ç½²åˆ°æ”¯æŒ PHP ä¸ MySQL çš„æœåŠ¡å™¨

æ¨èéƒ¨ç½²åˆ°ä½¿ç”¨ HTTPS åè®®çš„æœåŠ¡å™¨ï¼Œä»¥ä¿éšœå®‰å…¨ã€‚

### 5. è®¾ç½®æ’­æ”¾å™¨å‚æ•°

ç¤ºä¾‹è®¿é—®ï¼š

```url
https://your-domain.com/index.html?url=/path/to/video.mp4&dmk=/path/to/danmuku.xml&id=video001
```

- `url`: è§†é¢‘æ–‡ä»¶è·¯å¾„
- `dmk`: å¼¹å¹•æ–‡ä»¶è·¯å¾„ï¼ˆXMLæˆ–JSONï¼‰
- `id`: è§†é¢‘å”¯ä¸€æ ‡è¯†ï¼Œç”¨äºåœ¨çº¿ç»Ÿè®¡

---

## ğŸ“® å¼¹å¹•å‘é€æ¥å£è¯´æ˜

- è¯·æ±‚æ–¹å¼ï¼š`POST`
- å†…å®¹ç±»å‹ï¼š`application/json`

### è¯·æ±‚ç¤ºä¾‹ï¼š

```json
{
  "dmkUrl": "/dmk/video.xml",
  "text": "è¿™æ˜¯ä¸€æ¡å¼¹å¹•",
  "time": 12.345,
  "color": "#FF0000",
  "mode": 0
}
```

### å“åº”ç¤ºä¾‹ï¼š

æˆåŠŸï¼š

```json
{"success": true, "message": "å¼¹å¹•å‘é€æˆåŠŸ"}
```

å¤±è´¥ï¼š

```json
{"success": false, "message": "å¼¹å¹•ä¿å­˜å¤±è´¥ï¼Œæƒé™ä¸è¶³"}
```

---

## ğŸ–¼ï¸ ç•Œé¢å±•ç¤º



æ’­æ”¾å™¨ç‰¹è‰²ï¼š

- è‡ªå®šä¹‰æ§åˆ¶æ ï¼ˆå¼¹å¹•å¼€å…³ã€åˆ—è¡¨ã€å…¨å±ã€å¿«è¿›ï¼‰
-
- åœ¨çº¿äººæ•°ç»Ÿè®¡ä¸çƒ­åº¦å›¾
-

---

## âš ï¸ æ³¨æ„äº‹é¡¹

- æœåŠ¡å™¨éœ€å¼€å¯ PHPï¼Œå¹¶å®‰è£… MySQL æ•°æ®åº“ï¼Œç¡®ä¿æ•°æ®åº“è®¿é—®æƒé™ã€‚
- æ¨èä½¿ç”¨ HTTPSï¼Œä¿æŠ¤ç”¨æˆ·æ•°æ®å®‰å…¨ã€‚

---

## ğŸ§ª æ¼”ç¤ºç«™ç‚¹

ğŸ‘‰ [åœ¨çº¿é¢„è§ˆåœ°å€](https://player.oldbili.fun/?url=https://limeblogs.github.io/ubc2/vid/av14224600125.mp4&dmk=https://oldbili.github.io/dmku/%E2%80%9C%E4%B8%80%E6%BC%94%E4%B8%81%E7%9C%9F_%E4%BE%BF%E5%85%A5%E6%88%8F_%E5%BE%97%E5%A4%AA%E6%B7%B1%E2%80%9D%E2%80%94%E2%80%94%E4%B8%81%E7%9C%9F%E8%83%BD%E9%87%8F%E5%8D%95%E6%9B%B2%E3%80%8A%E7%BE%A4%E4%B8%81%E3%80%8B.26554729651.xml)


---

## ğŸ“œ å¼€æºåè®®

MIT License - æ¬¢è¿è‡ªç”±ä½¿ç”¨ä¸äºŒæ¬¡å¼€å‘ã€‚

---

## ğŸ‘¥ å¼€å‘å›¢é˜Ÿ

- GitHubï¼š[@oldbili](https://github.com/oldbili) / @nsty / [@Dos7t3r](https://github.com/Dos7t3r)
- åä½œå·¥å…·ï¼šChatGPT & [v0.dev](https://v0.dev)

---

